# SPDX-License-Identifier: Apache-2.0
# Copyright 2023 Authors of Nimbus

apiVersion: intent.security.nimbus.com/v1
kind: SecurityIntent
metadata:
  name: pkg-mgr-exec-global
spec:
  intent:
    id: swDeploymentTools
    description: "Do not allow the execution of package managers inside the containers"
    action: Block
    mode: strict
---
apiVersion: intent.security.nimbus.com/v1
kind: SecurityIntent
metadata:
  name: unauthorized-nef-access-global
spec:
  intent:
    id: unAuthorizedNEFAccess
    action: Block
    mode: strict
---
apiVersion: intent.security.nimbus.com/v1
kind: SecurityIntent
metadata:
  name: dns-manipulation-global
spec:
  intent:
    id: dnsManipulation
    action: Block
---
apiVersion: intent.security.nimbus.com/v1
kind: ClusterSecurityIntentBinding
metadata:
  name: multiple-sis-binding-global
spec:
  intents:
    - name: pkg-mgr-exec-global
    - name: unauthorized-nef-access-global
    - name: dns-manipulation-global
  selector:
    resources:
      - kind: Deployment # What else it can be? DS,Sts?
        name: nginx
        namespace: default
      - kind: Deployment
        name: ubuntu-1-deployment
        namespace: multiubuntu
