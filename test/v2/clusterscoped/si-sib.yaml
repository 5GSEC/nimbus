# SPDX-License-Identifier: Apache-2.0
# Copyright 2023 Authors of Nimbus

apiVersion: intent.security.nimbus.com/v1
kind: SecurityIntent
metadata:
  name: pkg-mgr-exec-single-global
spec:
  intent:
    id: swDeploymentTools
    description: "Do not allow execution of package managers inside the containers"
    action: Block
    mode: Strict
---
apiVersion: intent.security.nimbus.com/v1
kind: ClusterSecurityIntentBinding
metadata:
  name: pkg-mgr-exec-single-global-binding
spec:
  intents:
    - name: pkg-mgr-exec-single-global
  selector:
    resources:
      - kind: Deployment
        name: nginx
        namespace: default