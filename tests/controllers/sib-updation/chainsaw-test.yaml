apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: sib-updation
spec:
  timeouts:
    assert: 10s
  steps:
  - name: 01-Create-Resources 
    try:
      - apply:
          file: ../../../examples/namespaced/dns-manipulation-si-sib.yaml
      - assert:
          file: ../../../examples/namespaced/dns-manipulation-si-sib.yaml
  - name: 02-Update-SIB
    try:
      - apply:
          file: updated-sib.yaml
      - assert:
          file: updated-sib.yaml 
  - name: 03-Assert-NP
    try:
      - script:
          content: kubectl get np -n $NAMESPACE dns-manipulation-binding -o=jsonpath='{.spec.selector.matchLabels.app}'
          check: 
            (contains($stdout, 'frontend')): true

    
