apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  annotations:
    app.kubernetes.io/managed-by: nimbus-kubearmor
  name: exploit-pfa-binding-preventexecutionfromtemporlogsfolders
  namespace: default
  ownerReferences:
  - apiVersion: intent.security.nimbus.com/v1alpha1
    blockOwnerDeletion: true
    controller: true
    kind: NimbusPolicy
    name: exploit-pfa-binding
spec:
  action: Block
  capabilities: {}
  file: {}
  message: Mitigate the execution of harmful binaries which may result in exploiting
    public facing application
  network: {}
  process:
    action: Block
    matchDirectories:
    - dir: /var/tmp/
      recursive: true
    - dir: /tmp/
      recursive: true
    - dir: /var/log/
      recursive: true
    - dir: /app/logs/
      recursive: true
    - dir: /logs/
      recursive: true
    - dir: /etc/
      recursive: true
  selector:
    matchLabels:
      app: nginx
  syscalls: {}