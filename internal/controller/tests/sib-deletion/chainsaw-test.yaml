apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: sib-deletion
spec:
  timeouts:
    assert: 10s
  steps:

  - name: step-01 
    try:
      - apply:
          # file is relative to the test folder
          file: ../../../../examples/namespaced/dns-manipulation-si-sib.yaml
      - assert:
          file: ../../../../examples/namespaced/dns-manipulation-si-sib.yaml
  - name: step-02
    try:
      - script:
          content: kubectl delete sib -n $NAMESPACE dns-manipulation-binding
  - name: step-03
    try:
      - script:
          content: kubectl get np -n $NAMESPACE dns-manipulation-binding
          check: 
            ($error != null): true

    
